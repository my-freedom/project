Site.productSlide={};(function(z,G,k){var p,A=-1,H,h,Z,V=null,f="",L="",w;G.data={};G.dom={};function u(){var aa=[];aa.push('<div class="fk-slideForProduct" id="fk-productSlidePanel" style="display:none;">');aa.push('	<div class="f-contentBg J_contentBg"></div>');aa.push('	<div class="f-content J_content" id="fk-productSlideContent">');aa.push('		<div class="f-innerContent">');N(aa);aa.push("		</div>");aa.push('		<a href="javascript:;" class="f-turnLeft J_turnLeft" onclick="return false;" hidefocus="true">向右</a>');aa.push('		<a href="javascript:;" class="f-turnRight J_turnRight" onclick="return false;" hidefocus="true">向左</a>');aa.push('		<a href="javascript:;" class="f-close J_close" onclick="return false;" title="关闭" hidefocus="true">关闭</a>');aa.push("	</div>");aa.push("</div>");return aa}function N(aa){aa.push('<div class="f-multiContent J_multiContent">');y(aa);aa.push("</div>");aa.push('<div class="f-albumsContent J_albumsContent">');t(aa);aa.push("</div>")}function y(aa){aa.push('<div class="f-multiContent-left J_multiContentLeft">');x(aa);aa.push("</div>");aa.push('<div class="f-multiContent-right J_multiContentRight">');J(aa);aa.push("</div>")}function x(aa){aa.push('<div class="f-productPicContent J_productPicContent">');aa.push('	<div class="f-productImg J_productImg">');aa.push('		<div class="f-productImgLoading"></div>');aa.push("	</div>");aa.push('	<div class="f-productImgGroup J_productImgGroup" style="display:none;">');aa.push('		<div class="f-productImgGroupBg"></div>');aa.push('		<div class="f-imgListWrap J_imgListWrap">');aa.push("		</div>");aa.push('		<a href="javascript:;" onclick="return false;" class="f-groupLeft J_groupLeft" hidefocus="true">向左</a>');aa.push('		<a href="javascript:;" onclick="return false;" class="f-groupRight J_groupRight" hidefocus="true">向右</a>');aa.push("	</div>");aa.push("</div>");aa.push('<div class="f-shareContent J_shareContent">');aa.push("</div>")}function J(aa){aa.push('<div class="f-productDetailContent J_productDetailContent">');aa.push("</div>");aa.push('<div class="f-productBuyContent J_productBuyContent">');aa.push("</div>")}function F(){if(!G.data.nowData){return""}var ag=[],ah=[],af=G.data,aa=af.nowData,aq=aa.propList||[],ap="g_stress mallPriceBig f-mallPriceWrap",ao="g_minor mallMarketPrice f-mallPriceWrap",al="",an,ac,aj,ad,am,ak,ae,ai,ab;an=aa.name;ai=aq.length;for(ae=0;ae<ai;ae++){ab=aq[ae];ac=ab.name;aj=ab.type;ad=ab.fileId;am=ab.value||"";if(z.trim(am).length<1){continue}if(aj==11){al=ap}else{if(aj==12){al=ao}else{al=""}}ah.push('<p class="f-propContent">');ah.push('<label class="f-propName" title="'+ac+'">'+ac+'<span class="f-colon">:</span></label>');ah.push('<label class="f-propValue '+al+'">');if(aj==11){ah.push('	<span class="f-currencyVal">'+Z.choiceCurrencyVal+"</span>");ah.push('	<span class="f-mallPrice mallPrice">'+am+"</span>")}else{if(aj==12){ah.push('	<span class="f-currencyVal">'+Z.choiceCurrencyVal+"</span>");ah.push('	<span class="mallPrice">'+am+"</span>")}else{ah.push(am)}}ah.push("	</label>");ah.push("</p>")}ag.push('<div class="f-productNameContent">');ag.push('	<p class="f-productName">');if(V.titleClick){ak=Z.productDetailUrl+"?id="+af.id;ag.push('<a class="f-productTitle" href="'+ak+'" target="_blank">');ag.push(an);ag.push("</a>")}else{ag.push(an)}ag.push("	</p>");ag.push("</div>");ag.push('<div class="f-underlineContent">');ag.push('	<div class="f-underline"></div>');ag.push("</div>");ag.push('<div class="f-propListContent">');ag.push(ah.join(""));ag.push("</div>");return ag.join("")}function O(){if(!Z.mallOpen){return}if(V.hiddenBuybtn){return}var ac=[],af=G.dom,ab=Z.addCartText||"",ad=Z.buyNowText||"",ae=Z.addCartClickEvent||"",aa=Z.buyNowClickEvent||"";ac.push('<div class="f-buyContent">');ac.push('	<a href="javascript:;" onclick="'+ae+'" hidefocus="true" class="fk-mall-addCart f-addCart"><span>'+ab+"</span></a>");ac.push('	<a href="javascript:;" onclick="'+aa+'" hidefocus="true" class="fk-mallBuy-big f-buyNow"><span class="bug-img">&nbsp;</span><span>'+ad+"</span></a>");ac.push("</div>");return ac.join("")}function t(aa){aa.push('<div class="f-albumsWrap J_albumsWrap">');aa.push("</div>");aa.push('<a href="javascript:;" onclick="return false;" class="f-albumsLeft J_albumsLeft" hidefocus="true">向左</a>');aa.push('<a href="javascript:;" onclick="return false;" class="f-albumsRight J_albumsRight" hidefocus="true">向右</a>')}function v(){var ab=G.dom,aa=G.data;ab.productDetailContent.empty();ab.productDetailContent.append(F());ab.productBuyContent.empty();ab.productBuyContent.append(O())}function n(ac){var ad=G.data,ab={src:"",width:-1,height:-1},aa={};z.extend(aa,ab,ac);C(aa)}function Q(){var ad=G.data,ac=ad.nowData,ae,ab,aa;if(ac){ae=ac.picPath;ab=ac.picwidth;aa=ac.picHeight;n({src:ae,width:ab,height:aa})}}function C(af){var ad=G.dom,ab=ad.productImg,aa=af.src||"",ah=390,ai=390,ae=new Image(),ag=ab.find(".J_nowImg"),ac,aj;if(z.trim(aa).length<1){Fai.ing("找不到该图片",true)}if(ag.length>0){if(ag.attr("src")==z.trim(aa)){return}}ab.empty().append('<div class="f-productImgLoading"></div>');if(H&&H.onload){H.onload=function(){}}ae.onload=function(){var ap=false,ao=false,al="",an=[],am=[],ak,aq;ac=ae.width;ak=ac;aj=ae.height;aq=aj;if(ac>=aj&&ac>ah){ap=true;ak=ah}else{if(aj>ai){ao=true;aq=ai}}if(ap){al+="width:"+ak+"px;"}if(ao){al+="height:"+aq+"px;"}if(ap&&!ao){aq=ah*ae.height/ae.width}if(!ap&&ao){ak=ai*ae.width/ae.height}if(!V.picZoom&&V.picPopup){am.push('	<a class="f-imgClick" href="'+aa+'" target="_blank" title="点击查看大图">');am.push('		<img class="J_nowImg " src="'+aa+'" style="'+al+'" />');am.push("	</a>")}else{am.push('	<img class="J_nowImg " src="'+aa+'" style="'+al+'" />')}an.push('<table cellpadding="0" cellspacing="0" class="f-imgContainer">');an.push("	<tr>");an.push("		<td>");an.push(am.join(""));an.push("		</td>");an.push("	</tr>");an.push("</table>");if(V.picZoom){am=[];am.push(an.join(""));an=[];an.push('<div class="cloud-zoom f-imgWrap" href="'+aa+'">');an.push(am.join(""));an.push("</div>")}ab.empty();ab.append(an.join(""));if(V.picZoom){ag=ab.find(".cloud-zoom");ag.attr("rel","adjustX:-4, adjustY:-4, maxWidth:"+ah+", maxHeight:"+ai+',position:"inside"');ag.CloudZoom({imageHeight:aj,imageWidth:ac});if(V.picPopup){setTimeout(function(){ab.find(".mousetrap").append('<a href="'+aa+'" target="_blank" hidefocus="true" class="f-popupImgA" title="点击查看大图"></a>')},30)}}};H=ae;setTimeout(function(){ae.src=aa},50)}function b(ac){var ah=[],ai=[],al=68,aj=0,ag=G.data,ac=ag.id,an=false,ao="",am="",ab=0,ae=0,aa,ad,af,ak;ak=p.length;for(af=0;af<ak;af++){if(p[af].id==ac){aa=p[af];an=true;break}}if(!an){return""}ad=aa.picPathList||[];ak=ad.length;for(af=0;af<ak;af++){ao=ad[af].thumbPath;am=ad[af].path;ab=ad[af].picWidth;ae=ad[af].picHeight;ai.push("<li>");ai.push('	<a href="javascript:;" class="J_pic" onclick="return false;" path="'+am+'" picwidth="'+ab+'" picheight="'+ae+'" >');ai.push('		<img src="'+ao+'" style="display: block; width:60px; height:60px;" />');ai.push("	</a>");ai.push("</li>");aj+=al}ah.push('			<div class="f-imgListOuter J_imgListOuter">');ah.push('				<ul class="f-imgList J_imgList" style="width:'+aj+'px;" _num="0">');ah.push(ai.join(""));ah.push("				</ul>");ah.push("			</div>");return ah.join("")}function a(){var ac=G.dom,ab=G.data,aa=ac.groupBtn;aa.left.removeClass("f-BtnDisabled f-BtnEnabled");aa.right.removeClass("f-BtnDisabled f-BtnEnabled");ac.imgListWrap.empty();ac.imgListWrap.append(b(ab.id));ac.imgListOuter=ac.imgListWrap.find(".J_imgListOuter");ac.imgList=ac.imgListWrap.find(".J_imgList");ac.imgList.find(".J_pic").hover(function(){n({src:z(this).attr("path"),width:z(this).attr("picwidth"),height:z(this).attr("picheight")})})}function o(){var ae=[],af=[],aa=90,ai=0,ac,ah,ab;if(p&&p.length>0){for(var ad=0,ag=p.length;ad<ag;ad++){ac=p[ad];ah=ac.picThumbPath||"";ab=ac.id;af.push("<li>");af.push('	<div class="f-albumsImgWrap J_albumsImgWrap J_albumsImgWrap'+ab+'">');af.push('		<a href="javascript:;" onclick="return false;" class="f-albumsImg J_albumsImg J_albumsImg'+ab+'" _id="'+ab+'">');af.push('			<img src="'+ah+'" style="display: block; width:80px; height:80px;" />');af.push("		</a>");af.push('		<div class="f-albumsImgTip"></div>');af.push("	</div>");af.push("</li>");ai+=aa}ae.push('<div class="f-albumsOuter J_albumsOuter">');ae.push('	<ul class="f-albums J_albums" style="width:'+ai+'px;" _num="0">');ae.push(af.join(""));ae.push("	</ul>");ae.push("</div>")}return ae.join("")}function j(){var ab=G.dom,aa;ab.albumsWrap.empty();ab.albumsWrap.append(o());ab.albumsOuter=ab.albumsWrap.find(".J_albumsOuter");ab.albums=ab.albumsWrap.find(".J_albums");ab.albumsImgWrap=ab.albums.find(".J_albumsImgWrap");aa=ab.albums.children().first().outerWidth()||90,ab.albums.find(".J_albumsImg").click(function(){var ad=z(this).attr("_id"),ac=c(ad);e(ad)});s({index:A,visibleNum:2});X()}function l(){var ab=G.dom,aa=G.data;ab.albumsImgWrap.removeClass("f-albumsImgWrap-selected");ab.albumsImgWrap.filter(".J_albumsImgWrap"+aa.id).addClass("f-albumsImgWrap-selected")}function E(ab){var aa=G.dom,ae=aa.albums,ai=aa.albumsOuter,ac=aa.albumsBtn,ad=0,af={content:ae,contentOuter:ai,button:ac,scrollRow:true,visibleNum:2},ah={},ag=ab.changeProduct||false;z.extend(ah,af,ab);if(ah.scrollRow){r(ah)}else{ad=Y(ah);s({index:ad,visibleNum:2});q(ad)}M(ah)}function S(ae){var ag=G.dom,af=ag.imgList,aa=ag.imgListOuter,ad=ag.groupBtn,ac={content:af,contentOuter:aa,button:ad,scrollRow:true},ab={};z.extend(ab,ac,ae);r(ab);M(ab)}function r(ae){var ai=ae.content,ab=ai.children(),ag=ab.length,ah=ab.first().outerWidth(),af=ae.contentOuter.width(),am=parseInt(af/ah),al=ae.visibleNum||0,ak=am-al,ac=parseInt((ag-al)/ak),aa=parseInt(ai.attr("_num"))||0,ad=0,aj=ae.direction;if(ag<=am){ac=0}else{if((ac*ak-ag)>=0){ac-=1}}if(aj){ad=aa+1;if(ad>ac){ad=0;ai.stop(true).animate({left:"0"});ai.attr("_num",ad)}else{ai.stop(true).animate({left:-(ad*ak*ah)+"px"});ai.attr("_num",ad)}}else{ad=aa-1;if(ad<0){ad=ac}ai.stop(true).animate({left:-(ad*ak*ah)+"px"});ai.attr("_num",ad)}}function s(af){var ac=G.dom,ak=ac.albums,ab=ak.children(),ai=ab.length,aj=ab.first().outerWidth(),ag=ac.albumsOuter.width(),ao=parseInt(ag/aj),an=af.visibleNum||0,am=ao-an,ad=0,aa=parseInt(ak.attr("_num"))||0,ae=0,al=0,ah=af.index;if(an>parseInt(ao/2)){an=parseInt(ao/2);am=ao-an}if(ai>ao&&ah>=am){ad=parseInt((ai-an)/am);if((ad*am-ai)>=0){ad-=1}ae=parseInt((ah-an)/am);al=parseInt(ah/am)}else{ad=0;ae=0;al=0}if(ae>ad){ae=0}else{if(ae<0){ae=ad}}if(aa==ae||aa==al){return}ak.stop(true).animate({left:-(ae*am*aj)+"px"});ak.attr("_num",ae)}function Y(ag){var ak=ag.content,ac=ak.children(),ai=ac.length,aj=ac.first().outerWidth(),ah=ag.contentOuter.width(),ab=0,aa=A,al=ag.direction,an=0,am=1,ae=ag.cycle||false,ad,af;ad=ai-(ai%am);if(al){af=aa+am;if(af<ad){an=af}else{if(aa>ad){an=0}else{if(ad==ai){an=ad-1;if(ae){an=0}return an}if(ad==aa){an=ad;return an}an=ad}}}else{af=aa-am;if(af>ab){an=af}else{if(aa<ab){an=0}else{an=ab;if(ab==aa){if(ae){an=ai-1}return an}}}}return an}function M(ae){var aj=ae.content,ab=aj.children(),ah=ab.length,ai=ab.first().outerWidth(),af=ae.contentOuter.width(),ag=ae.button,am=parseInt(af/ai),al=ae.visibleNum||0,ak=am-al,ac=parseInt((ah-al)/ak),aa=parseInt(aj.attr("_num"))||0,ad=0;if(ah<=am){ac=0}else{if((ac*ak-ah)>=0){ac-=1}}ad=aa+1;if(ad>ac){ad=0;ag.right.addClass("f-BtnDisabled").removeClass("f-BtnEnabled")}else{ag.right.addClass("f-BtnEnabled").removeClass("f-BtnDisabled")}ad=aa-1;if(ad<0){ag.left.addClass("f-BtnDisabled").removeClass("f-BtnEnabled")}else{ag.left.addClass("f-BtnEnabled").removeClass("f-BtnDisabled")}}function X(){var ag=G.dom,af=ag.albums,aa=ag.albumsOuter,ae=ag.albumsBtn,ad=0,ac={content:af,contentOuter:aa,button:ae,scrollRow:true},ab={};z.extend(ab,ac,{scrollRow:true});M(ab)}function R(){var af=G.dom,ae=af.imgList,aa=af.imgListOuter,ad=af.groupBtn,ac={content:ae,contentOuter:aa,button:ad,scrollRow:true},ab={};z.extend(ab,ac,{scrollRow:true});M(ab)}function U(aa){var ab=[];ab.push(aa.qsUrl);ab.push("&cmd=list");z.ajax({type:"get",cache:false,url:Site.genAjaxUrl("productSlide_h.jsp")+ab.join(""),error:function(){Fai.ing("服务繁忙，请稍候重试",false)},success:function(ae){var ac=z.parseJSON(ae),ad=G.data;if(ac.success){p=ac.list;V=ac.setInfo;Z=ac.data;L=Z.css;if(Fai.top._manageMode){w=ac.itemList}if(p.length<1){Fai.ing("没有产品信息");return}if(Z.productId==-1){ad.id=p[0].id}else{ad.id=Z.productId}A=c(ad.id);if(A==-1){Fai.ing("没有该产品信息");return}else{ad.nowData=p[A]}m()}else{Fai.ing("获取数据失败",false)}}})}function i(){if(!V.shareShow){return}G.dom.shareContent.addClass("f-shareContentIniting");clearTimeout(h);h=setTimeout(function(){var aa=[];aa.push("cmd=share");aa.push("&id="+G.data.id);aa.push("&browserTitle="+Fai.top.document.title);z.ajax({type:"post",url:Site.genAjaxUrl("productSlide_h.jsp"),data:aa.join(""),error:function(){Fai.ing("服务繁忙，请稍后重试",false)},success:function(ad){var ac=z.parseJSON(ad),ae=G.dom,ab="";if(ac.success){ab=ac.content||""}else{Fai.ing("获取数据失败",false)}ae.shareContent.removeClass("f-shareContentIniting");ae.shareContent.empty().append(ab)}})},300)}function c(ad){var ab=-1,ac,aa;if(p&&p.length>0){aa=p.length;for(ac=0;ac<aa;ac++){if(p[ac].id==ad){ab=ac;break}}}return ab}function q(aa){if(A==aa){return}if(p&&p[aa]){e(p[aa].id)}}function e(ac){var aa=-1,ab=G.data;aa=c(ac);if(aa==-1){Fai.ing("没有该产品信息");return}else{if(aa==A){return}}A=aa;ab.id=parseInt(ac);ab.nowData=p[A];d()}function d(){G.dom.imgList=null;Q();v();a();i();l();setTimeout(function(){T()},50)}function D(ab){var aa=new Image();aa.src=ab}function T(){var ae=G.data,ad=ae.nowData,ac=ad.picPathList||[],ab,aa;aa=ac.length;for(ab=0;ab<aa;ab++){D(ac[ab].path)}}function W(){var aa=G.dom;aa.productDetailContent.empty();aa.productBuyContent.empty();aa.productImg.empty();aa.imgListWrap.empty();aa.albumsWrap.empty();aa.shareContent.empty()}function I(){p=null;A=-1;H=null;h=null;Z=null;V=null;G.data={}}function g(){var ad=G.dom,aa=ad.panel,af=ad.panelBtn,ac=ad.groupBtn,ab=ad.albumsBtn,ae;af.close.click(function(){K()});af.left.click(function(){E({scrollRow:false,direction:false,cycle:true,changeProduct:true})});af.right.click(function(){E({scrollRow:false,direction:true,cycle:true,changeProduct:true})});ab.left.click(function(){E({scrollRow:true,direction:false})});ab.right.click(function(){E({scrollRow:true,direction:true})});ac.left.click(function(){S({scrollRow:true,direction:false})});ac.right.click(function(){S({scrollRow:true,direction:true})});ad.contentBg.click(function(){K()});ad.productPicContent.hover(function(){if(!ad.imgList){return}var ag=ad.imgList.children();if(ag&&ag.length<2){return}ae=setTimeout(function(){ad.productImgGroup.slideDown("normal",function(){R()})},250)},function(){clearTimeout(ae);ad.productImgGroup.slideUp()});ad.content.mouseleave(function(){clearTimeout(ae);ad.productImgGroup.slideUp()})}function B(aa){var ab=G.dom;ab.panel=Fai.top.$("#fk-productSlidePanel");ab.content=ab.panel.find(".J_content");ab.contentBg=ab.panel.find(".J_contentBg");ab.panelBtn={};ab.panelBtn.left=ab.panel.find(".J_turnLeft");ab.panelBtn.right=ab.panel.find(".J_turnRight");ab.panelBtn.close=ab.panel.find(".J_close");ab.multiContent=ab.panel.find(".J_multiContent");ab.albumsContent=ab.panel.find(".J_albumsContent");ab.multiContentLeft=ab.multiContent.find(".J_multiContentLeft");ab.multiContentRight=ab.multiContent.find(".J_multiContentRight");ab.productDetailContent=ab.multiContentRight.find(".J_productDetailContent");ab.productBuyContent=ab.multiContentRight.find(".J_productBuyContent");ab.shareContent=ab.multiContentLeft.find(".J_shareContent");ab.productPicContent=ab.multiContentLeft.find(".J_productPicContent");ab.productImg=ab.multiContentLeft.find(".J_productImg");ab.productImgGroup=ab.multiContentLeft.find(".J_productImgGroup");ab.imgListWrap=ab.multiContentLeft.find(".J_imgListWrap");ab.groupBtn={};ab.groupBtn.left=ab.multiContentLeft.find(".J_groupLeft");ab.groupBtn.right=ab.multiContentLeft.find(".J_groupRight");ab.albumsWrap=ab.albumsContent.find(".J_albumsWrap");ab.albumsBtn={};ab.albumsBtn.left=ab.albumsContent.find(".J_albumsLeft");ab.albumsBtn.right=ab.albumsContent.find(".J_albumsRight");if(typeof aa.func=="function"){setTimeout(function(){aa.func.apply(G,arguments)},30)}}function m(){P({func:function(){var ab=G.dom;if(ab.panel&&ab.panel.length>0){if(ab.panel.is(":hidden")){ab.panel.show()}}else{Fai.top.$("#fk-productSlidePanel").show()}Q();v();a();j();i();l();setTimeout(function(){T()},50)}});if(Fai.top._manageMode&&w&&w.length>0){var aa=G.dom.content;aa.off("mousemove.productSlide").on("mousemove.productSlide",function(){Site.addEditLayer("fk-productSlideContent",w,100,{extCls:"fk-productSlideEditLayer"})});aa.off("mouseleave.productSlide").on("mouseleave.productSlide",function(){Site.removeEditLayer("fk-productSlideContent")})}}function K(){var aa=G.dom;if(Fai.top._manageMode&&w){Site.removeEditLayer("fk-productSlideContent")}aa.panel&&aa.panel.hide();I();G.dom={};f="";L="";w=null;Fai.top.$("#fk-productSlidePanel").remove()}G.init=function(aa){K();Fai.top.$("body").append(u().join(""));f=aa;U({qsUrl:aa});B({func:g})};G.refresh=function(){W();I();U({qsUrl:f})};function P(ab){if(Fai.top.$("#fk-productSlideCss").length<1&&z.trim(L).length>0){var aa=document.createElement("link");aa.setAttribute("type","text/css");aa.setAttribute("rel","stylesheet");aa.setAttribute("href",L);aa.setAttribute("id","fk-productSlideCss");Fai.top.$("head").append(aa);aa.onload=function(){if(typeof ab.func=="function"){ab.func.apply(G,arguments)}}}else{if(typeof ab.func=="function"){ab.func.apply(G,arguments)}}}})(jQuery,Site.productSlide);